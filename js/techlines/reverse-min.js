!function(e,r){"function"==typeof define&&define.amd?define(r):"object"==typeof exports?module.exports=r():e.SVGPathEditor=r()}(this,function(){function e(e){var r,t,s,i,l,n,o=(e=e.replace(/,/g," ").replace(/-/g," -").replace(/\s*([achlmqstvzACHLMQSTVZ])\s*/g," $1 ").replace(/\s+/g," ")).replace(/([a-zA-Z])\s?/g,"|$1").split("|"),p=o.length,a=[],f=[],h=0,u=0,c=0,g=0,m=0,v=0,d=0,M=0,L=0,C=0,Z=0,z=0,A=0,Q="";for(r=1;r<p;r++)if(i=(s=(t=o[r]).substring(0,1)).toLowerCase(),f=a=t.replace(s,"").trim().split(" ").filter(function(e){return""!==e}),l=(a=a.map(parseFloat)).length,"m"===i){if(Q+="M ","m"===s?(c+=a[0],g+=a[1]):(c=a[0],g=a[1]),h=c,u=g,Q+=c+" "+g+" ",l>2)for(n=0;n<l;n+=2)"m"===s?(c+=a[n],g+=a[n+1]):(c=a[n],g=a[n+1]),Q+="L "+c+" "+g+" "}else if("l"===i)for(n=0;n<l;n+=2)"l"===s?(c+=a[n],g+=a[n+1]):(c=a[n],g=a[n+1]),Q+="L "+c+" "+g+" ";else if("h"===i)for(n=0;n<l;n++)"h"===s?c+=a[n]:c=a[n],Q+="L "+c+" "+g+" ";else if("v"===i)for(n=0;n<l;n++)"v"===s?g+=a[n]:g=a[n],Q+="L "+c+" "+g+" ";else if("q"===i)for(n=0;n<l;n+=4)"q"===s?(m=c+a[n],v=g+a[n+1],c+=a[n+2],g+=a[n+3]):(m=a[n],v=a[n+1],c=a[n+2],g=a[n+3]),Q+="Q "+m+" "+v+" "+c+" "+g+" ";else if("t"===i)for(n=0;n<l;n+=2)m=c+(c-m),v=g+(g-v),"t"===s?(c+=a[n],g+=a[n+1]):(c=a[n],g=a[n+1]),Q+="Q "+m+" "+v+" "+c+" "+g+" ";else if("c"===i)for(n=0;n<l;n+=6)"c"===s?(m=c+a[n],v=g+a[n+1],d=c+a[n+2],M=g+a[n+3],c+=a[n+4],g+=a[n+5]):(m=a[n],v=a[n+1],d=a[n+2],M=a[n+3],c=a[n+4],g=a[n+5]),Q+="C "+m+" "+v+" "+d+" "+M+" "+c+" "+g+" ";else if("s"===i)for(n=0;n<l;n+=4)m=c+(c-d),v=g+(g-M),"s"===s?(d=c+a[n],M=g+a[n+1],c+=a[n+2],g+=a[n+3]):(d=a[n],M=a[n+1],c=a[n+2],g=a[n+3]),Q+="C "+m+" "+v+" "+d+" "+M+" "+c+" "+g+" ";else if("a"===i)for(n=0;n<l;n+=7){L=a[n],C=a[n+1],Z=a[n+2];let e=!1;if((z=f[n+3]).length>1){let r=parseInt(z[0]),t=parseInt(z[1]),s=void 0;z.length>2&&(s=parseFloat(z.substring(2))),a[n+3]=r,a.splice(n+4,0,t),void 0!==s&&a.splice(n+5,0,s),e=!0}z=a[n+3],A=e?a[n+4]:f[n+4],!e&&A.length>1&&(a[n+4]=parseInt(A[0]),a.splice(n+5,0,parseFloat(A.substring(1)))),A=a[n+4],"a"===s?(c+=a[n+5],g+=a[n+6]):(c=a[n+5],g=a[n+6]),Q+="A "+L+" "+C+" "+Z+" "+z+" "+A+" "+c+" "+g+" "}else"z"===i&&(Q+="Z ",c=h,g=u);return Q.trim()}function r(e){var r,t,s,i,l,n,o,p=e.trim().split(" "),a=p.length,f=a-1,h=[],u=new RegExp("[QAZLCM]",""),c="Z"===p.slice(-1)[0].toUpperCase();for(t=0;t<a;t++){if(r=p[t],!u.test(r)){var g=p.slice(Math.max(t-3,0),3).join(" ");throw post=p.slice(t+1,Math.min(t+4,f)).join(" "),range=g+" ["+r+"] "+post,"Error while trying to reverse normalized SVG path, at position "+t+" ("+range+").\nEither the path is not normalised, or it's malformed."}if("A"!==r){if("C"===r)n=3,o=2;else if("Q"===r)n=2,o=1;else if("L"===r)n=1,o=1;else{if("M"!==r)continue;n=1,o=0}for(n===o&&h.push(r),l=0;l<n;l++)l===o&&h.push(r),s=p[++t],i=p[++t],h.push(i),h.push(s)}else h.push("0"===p[t+5]?"1":"0"),h.push(p[t+4]),h.push(p[t+3]),h.push(p[t+2]),h.push(p[t+1]),h.push(r),h.push(p[t+7]),h.push(p[t+6]),t+=7}h.push("M");var m,v="";for(m=h.length-1;m>0;m--)v+=h[m]+" ";return c&&(v+="Z"),v=v.replace(/M M/g,"Z M")}return{normalize:e,reverseNormalized:r,reverse:function(t,s){s=parseInt(s)==s&&s;var i,l=(t=e(t)).replace(/M/g,"|M").split("|");if(l.splice(0,1),!1!==s&&s>=l.length)return t;if(!1===s)l=l.map(function(e){return r(e.trim())});else{var n=l[s];n&&(i=r(n.trim()),l[s]=i)}return l.join(" ").replace(/ +/g," ").trim()}}});